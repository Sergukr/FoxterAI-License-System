//+------------------------------------------------------------------+
//|                                        11_panel_handlers.mqh    |
//|                 –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –ø–∞–Ω–µ–ª–∏ –¥–ª—è FoxterAI v2.0    |
//|                   –° –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–ú –ö–ù–û–ü–ö–ò "–ó–ê–ö–†–´–¢–¨ –†–û–ë–û–¢–ê"        |
//+------------------------------------------------------------------+

//+------------------------------------------------------------------+
//| –û–ë–†–ê–ë–û–¢–ö–ê –ù–ê–ñ–ê–¢–ò–Ø –ö–ù–û–ü–û–ö                                         |
//+------------------------------------------------------------------+
void HandleButtonClick(string buttonName) {
    //--- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    g_ButtonClicked = true;
    
    //--- –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê: –ó–ê–ö–†–´–¢–¨ –†–û–ë–û–¢–ê
    if(buttonName == PANEL_PREFIX + "BtnCloseRobot") {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        int result = MessageBox("–í–ù–ò–ú–ê–ù–ò–ï!\n\n" +
                               "–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–∫—Ä—ã—Ç—å —Ä–æ–±–æ—Ç–∞?\n\n" +
                               "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ:\n" +
                               "‚Ä¢ –ó–∞–∫—Ä–æ–µ—Ç –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏\n" +
                               "‚Ä¢ –£–¥–∞–ª–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–∞—Ä—ã\n" +
                               "‚Ä¢ –ó–∞–≤–µ—Ä—à–∏—Ç —Ä–∞–±–æ—Ç—É —ç–∫—Å–ø–µ—Ä—Ç–∞\n\n" +
                               "–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ —Ä–æ–±–æ—Ç –Ω–∞—á–Ω–µ—Ç —Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.\n\n" +
                               "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?",
                               "FoxterAI v2.0 - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è",
                               MB_YESNO | MB_ICONWARNING);
        
        if(result == IDYES) {
            Print("üî¥ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–æ–±–æ—Ç–∞");
            // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —á–∏—Å—Ç–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –∏–∑ storage_manager
            CleanShutdownRobot();
        } else {
            Print("‚ö†Ô∏è –ó–∞–∫—Ä—ã—Ç–∏–µ —Ä–æ–±–æ—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–æ");
        }
        ChartRedraw();
        return;
    }
    
    //--- START/STOP
    if(buttonName == PANEL_PREFIX + "BtnStartStop") {
        g_BotEnabled = !g_BotEnabled;
        Print(g_BotEnabled ? "–†–æ–±–æ—Ç –ó–ê–ü–£–©–ï–ù" : "–†–æ–±–æ—Ç –û–°–¢–ê–ù–û–í–õ–ï–ù");
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∏ —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ —Å—Ä–∞–∑—É
        ObjectSetString(0, buttonName, OBJPROP_TEXT, g_BotEnabled ? "STOP" : "START");
        ObjectSetInteger(0, buttonName, OBJPROP_BGCOLOR, g_BotEnabled ? C'198,40,40' : C'46,125,50');
        
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        ChartRedraw();
    }
    
    //--- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏
    else if(buttonName == PANEL_PREFIX + "BtnBuy") {
        g_TradeDirection = TRADE_BUY_ONLY;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBuy", OBJPROP_BGCOLOR, C'46,125,50');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnSell", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBoth", OBJPROP_BGCOLOR, C'66,66,66');
        Print("–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏: —Ç–æ–ª—å–∫–æ BUY");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnSell") {
        g_TradeDirection = TRADE_SELL_ONLY;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBuy", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnSell", OBJPROP_BGCOLOR, C'198,40,40');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBoth", OBJPROP_BGCOLOR, C'66,66,66');
        Print("–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏: —Ç–æ–ª—å–∫–æ SELL");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnBoth") {
        g_TradeDirection = TRADE_BOTH;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBuy", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnSell", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBoth", OBJPROP_BGCOLOR, C'33,150,243');
        Print("–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏: –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    
    //--- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞–∫—Å –æ—Ä–¥–µ—Ä–æ–≤ Buy
    else if(buttonName == PANEL_PREFIX + "BtnApplyMaxBuy") {
        string value = ObjectGetString(0, PANEL_PREFIX + "EditMaxBuy", OBJPROP_TEXT);
        int newMax = (int)StringToInteger(value);
        if(newMax > 0 && newMax <= 100) {
            g_MaxOrdersBuy = newMax;
            Print("–ú–∞–∫—Å Buy –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ", g_MaxOrdersBuy);
            SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        } else {
            Print("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞–∫—Å Buy: ", value);
            ObjectSetString(0, PANEL_PREFIX + "EditMaxBuy", OBJPROP_TEXT, IntegerToString(g_MaxOrdersBuy));
        }
        ChartRedraw();
    }
    
    //--- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞–∫—Å –æ—Ä–¥–µ—Ä–æ–≤ Sell
    else if(buttonName == PANEL_PREFIX + "BtnApplyMaxSell") {
        string value = ObjectGetString(0, PANEL_PREFIX + "EditMaxSell", OBJPROP_TEXT);
        int newMax = (int)StringToInteger(value);
        if(newMax > 0 && newMax <= 100) {
            g_MaxOrdersSell = newMax;
            Print("–ú–∞–∫—Å Sell –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ", g_MaxOrdersSell);
            SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        } else {
            Print("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞–∫—Å Sell: ", value);
            ObjectSetString(0, PANEL_PREFIX + "EditMaxSell", OBJPROP_TEXT, IntegerToString(g_MaxOrdersSell));
        }
        ChartRedraw();
    }
    
    //--- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏—Ç–∞
    else if(buttonName == PANEL_PREFIX + "BtnApplyProfit") {
        string value = ObjectGetString(0, PANEL_PREFIX + "EditProfit", OBJPROP_TEXT);
        double newProfit = StringToDouble(value);
        if(newProfit > 0 && newProfit <= 10) {
            g_BasketProfitPercent = newProfit;
            Print("–ü—Ä–æ—Ñ–∏—Ç % –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ", g_BasketProfitPercent);
            SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        } else {
            Print("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏—Ç–∞: ", value);
            ObjectSetString(0, PANEL_PREFIX + "EditProfit", OBJPROP_TEXT, DoubleToString(g_BasketProfitPercent, 2));
        }
        ChartRedraw();
    }
    
    //--- –ë–ï–ó –ë–´–°–¢–†–´–• –ö–ù–û–ü–û–ö –ü–†–û–§–ò–¢–ê (—É–¥–∞–ª–µ–Ω—ã BtnProfit01, BtnProfit05, BtnProfit10)
    
    //--- –¢–∏–ø –∫–æ—Ä–∑–∏–Ω—ã
    else if(buttonName == PANEL_PREFIX + "BtnBasketNone") {
        g_BasketType = BASKET_NONE;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketNone", OBJPROP_BGCOLOR, C'46,125,50');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketImm", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketAfter", OBJPROP_BGCOLOR, C'66,66,66');
        Print("–¢–∏–ø –∫–æ—Ä–∑–∏–Ω—ã: –±–µ–∑ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnBasketImm") {
        g_BasketType = BASKET_IMMEDIATE;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketNone", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketImm", OBJPROP_BGCOLOR, C'46,125,50');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketAfter", OBJPROP_BGCOLOR, C'66,66,66');
        Print("–¢–∏–ø –∫–æ—Ä–∑–∏–Ω—ã: –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnBasketAfter") {
        g_BasketType = BASKET_AFTER_N;
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketNone", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketImm", OBJPROP_BGCOLOR, C'66,66,66');
        ObjectSetInteger(0, PANEL_PREFIX + "BtnBasketAfter", OBJPROP_BGCOLOR, C'46,125,50');
        Print("–¢–∏–ø –∫–æ—Ä–∑–∏–Ω—ã: –ø–æ—Å–ª–µ N –æ—Ä–¥–µ—Ä–æ–≤");
        SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        ChartRedraw();
    }
    
    //--- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ N –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
    else if(buttonName == PANEL_PREFIX + "BtnApplyBasketN") {
        string value = ObjectGetString(0, PANEL_PREFIX + "EditBasketN", OBJPROP_TEXT);
        int newN = (int)StringToInteger(value);
        if(newN > 0 && newN <= 20) {
            g_BasketAfterN = newN;
            Print("–ö–æ—Ä–∑–∏–Ω–∞ –ø–æ—Å–ª–µ N –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: ", g_BasketAfterN);
            SavePanelSettings();  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
        } else {
            Print("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ N: ", value);
            ObjectSetString(0, PANEL_PREFIX + "EditBasketN", OBJPROP_TEXT, IntegerToString(g_BasketAfterN));
        }
        ChartRedraw();
    }
    
    //--- –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
    else if(buttonName == PANEL_PREFIX + "BtnCloseBuy") {
        if(g_BuySeries.active && g_BuySeries.count > 0) {
            Print("–≠–ö–°–¢–†–ï–ù–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï BUY –û–†–î–ï–†–û–í");
            CloseSeriesOrders(OP_BUY);
        } else {
            Print("–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö BUY –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è");
        }
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnCloseSell") {
        if(g_SellSeries.active && g_SellSeries.count > 0) {
            Print("–≠–ö–°–¢–†–ï–ù–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï SELL –û–†–î–ï–†–û–í");
            CloseSeriesOrders(OP_SELL);
        } else {
            Print("–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö SELL –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è");
        }
        ChartRedraw();
    }
    else if(buttonName == PANEL_PREFIX + "BtnCloseAll") {
        if(g_BuySeries.active || g_SellSeries.active) {
            Print("–≠–ö–°–¢–†–ï–ù–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï –í–°–ï–• –û–†–î–ï–†–û–í");
            CloseAllOrders();
        } else {
            Print("–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è");
        }
        ChartRedraw();
    }
    
    //--- –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ã—á–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫!
    //--- –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞
}

//+------------------------------------------------------------------+
//| –ü–†–û–í–ï–†–ö–ê, –Ø–í–õ–Ø–ï–¢–°–Ø –õ–ò –û–ë–™–ï–ö–¢ –ö–ù–û–ü–ö–û–ô                           |
//+------------------------------------------------------------------+
bool IsButton(string objName) {
    if(StringFind(objName, PANEL_PREFIX + "Btn") == 0) {
        return true;
    }
    return false;
}